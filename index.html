<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Jeu de plateau</title>
<style>
  body { margin: 0; font-family: Arial, sans-serif; background: #222; color: #fff; }
  #plateau { position: relative; width: 600px; height: 600px; margin: 20px auto; background: url('https://raw.githubusercontent.com/stephanelavallee89-crypto/Mon-jeux-/main/plateau%20jeux.jpg') no-repeat center/contain; }
  .pion { width: 40px; height: 40px; border-radius: 50%; position: absolute; text-align:center; line-height:40px; font-size:20px; font-weight:bold; }
  #bandeau { width: 600px; margin: 10px auto; background: #000; padding: 10px; min-height: 60px; position: relative; }
  #controls { width: 600px; margin: 10px auto; text-align:center; }
  button { margin: 5px; padding: 5px 10px; }
  #popup { position: absolute; background: rgba(0,0,0,0.8); padding: 10px; border-radius: 5px; display:none; color:#fff; }
  #de-container { display:inline-block; margin-left:20px; font-size:20px; }
  #tour-joueur { display:inline-block; margin-left:20px; font-size:20px; }
</style>
</head>
<body>

<div id="plateau"></div>
<div id="bandeau">Bienvenue ! Cliquez sur Start pour commencer.</div>
<div id="controls">
  Joueurs: 
  <select id="nb-joueurs">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
  </select>
  <button id="start">Start</button>
  <button id="lancer-de">Lancer Dé</button>
  <button id="reset">Reset</button>
  <button id="volume">Mute/Unmute</button>
  <div id="de-container">Dé: 0</div>
  <div id="tour-joueur">Tour: -</div>
</div>

<div id="popup"></div>
<audio id="musique" loop>
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
</audio>

<script>
const positions = {
  1: {x:0, y:0}, 2:{x:120,y:0},3:{x:240,y:0},4:{x:360,y:0},5:{x:480,y:0},
  6:{x:480,y:120},7:{x:480,y:240},8:{x:480,y:360},9:{x:480,y:480},10:{x:360,y:480},
  11:{x:240,y:480},12:{x:120,y:480},13:{x:0,y:480},14:{x:0,y:360},15:{x:0,y:240},
  16:{x:0,y:120},17:{x:120,y:120},18:{x:240,y:120},19:{x:360,y:120},20:{x:360,y:240},
  21:{x:360,y:360},22:{x:240,y:360},23:{x:120,y:360},24:{x:120,y:240},25:{x:240,y:240}
};

const actions = {
  1: {texte:"Tout le monde se sert à boire !", pop:"santé !", son:"https://www.soundjay.com/button/sounds/button-10.mp3"},
  2: {texte:"Fredonne la chanson que te souffle le joueur à ta droite", pop:"Met l'ambiance !", son:"https://www.soundjay.com/button/sounds/button-3.mp3"},
  3: {texte:"Embrasse le joueur à ta droite", pop:"smack", son:"https://www.soundjay.com/button/sounds/button-4.mp3"},
  4: {texte:"Pose une colle au joueur de ton choix", pop:"Culture G", son:"https://www.soundjay.com/button/sounds/button-2.mp3"},
  5: {texte:"Tout le monde trinque", pop:"tchin tchin", son:"https://www.soundjay.com/button/sounds/button-1.mp3"},
  6: {texte:"Echange un vêtement avec le joueur à ta gauche", pop:"Echange", son:"https://www.soundjay.com/button/sounds/button-5.mp3"},
  7: {texte:"Mime ce que te souffle le joueur de droite", pop:"Action!", son:"https://www.soundjay.com/button/sounds/button-6.mp3"},
  9: {texte:"Echange ton verre avec le joueur à ta droite", pop:"C'est bon... ou pas !", son:"https://www.soundjay.com/button/sounds/button-7.mp3"},
  10:{texte:"Désigne ton joueur favori", pop:"Love", son:"https://www.soundjay.com/button/sounds/button-8.mp3"},
  11:{texte:"Retour à la case départ !", pop:"AÏE", son:"https://www.soundjay.com/button/sounds/button-9.mp3"},
  12:{texte:"Dessine ce que te souffle le joueur à ta gauche", pop:"Draw", son:"https://www.soundjay.com/button/sounds/button-1.mp3"},
  13:{texte:"Pose une colle au joueur de ton choix", pop:"Culture G", son:"https://www.soundjay.com/button/sounds/button-2.mp3"},
  14:{texte:"Embrasse le joueur à ta gauche", pop:"Smak", son:"https://www.soundjay.com/button/sounds/button-4.mp3"},
  15:{texte:"Echange un vêtement avec le joueur à ta droite", pop:"Echange", son:"https://www.soundjay.com/button/sounds/button-5.mp3"},
  16:{texte:"Passe ton tour ! Et bois un coup", pop:"Stop!", son:"https://www.soundjay.com/button/sounds/button-6.mp3"},
  17:{texte:"Echange ton verre avec le joueur à ta gauche", pop:"C'est bon...ou pas!", son:"https://www.soundjay.com/button/sounds/button-7.mp3"},
  18:{texte:"Dessine ce que te souffle le joueur à ta droite", pop:"Draw", son:"https://www.soundjay.com/button/sounds/button-1.mp3"},
  19:{texte:"Avance de 3 cases", pop:"tchou tchou glou glou", son:"https://www.soundjay.com/button/sounds/button-3.mp3"},
  20:{texte:"Fredonne la chanson que te souffle le joueur à ta gauche", pop:"Met l'ambiance !", son:"https://www.soundjay.com/button/sounds/button-3.mp3"},
  21:{texte:"Pose une question osée au joueur de ton choix", pop:"Indiscretions", son:"https://www.soundjay.com/button/sounds/button-2.mp3"},
  22:{texte:"Cul sec !", pop:"glou glou", son:"https://www.soundjay.com/button/sounds/button-1.mp3"},
  23:{texte:"Mime ce que te souffle le joueur à ta gauche", pop:"Action!", son:"https://www.soundjay.com/button/sounds/button-6.mp3"},
  24:{texte:"Pose une colle au joueur de ton choix", pop:"Culture G", son:"https://www.soundjay.com/button/sounds/button-2.mp3"},
  25:{texte:"Tu as gagné le droit de demander le service que tu veux", pop:"winner!!!", son:"https://www.soundjay.com/button/sounds/button-9.mp3"}
};

let joueurs = [];
let nbJoueurs = 0;
let tour = 0;
let positionsJoueurs = {};
let musiqueOn = true;

const plateau = document.getElementById("plateau");
const bandeau = document.getElementById("bandeau");
const popup = document.getElementById("popup");
const deContainer = document.getElementById("de-container");
const tourContainer = document.getElementById("tour-joueur");
const musique = document.getElementById("musique");

document.getElementById("start").addEventListener("click",()=>{
  nbJoueurs = parseInt(document.getElementById("nb-joueurs").value);
  plateau.innerHTML="";
  joueurs=[];
  positionsJoueurs={};
  for(let i=1;i<=nbJoueurs;i++){
    const pion = document.createElement("div");
    pion.classList.add("pion");
    pion.style.backgroundColor=`hsl(${i*60},70%,50%)`;
    pion.textContent=i;
    plateau.appendChild(pion);
    joueurs.push(pion);
    positionsJoueurs[i]=1;
    pion.style.left = positions[1].x + i*10 + "px";
    pion.style.top = positions[1].y + i*10 + "px";
  }
  tour=1;
  tourContainer.textContent = "Tour: Joueur "+tour;
  afficherAction(1);
  musique.play();
});

document.getElementById("lancer-de").addEventListener("click",()=>{
  if(nbJoueurs==0) return;
  const de = Math.floor(Math.random()*6)+1;
  deContainer.textContent = "Dé: "+de;
  let joueurActuel = tour;
  let pos = positionsJoueurs[joueurActuel];
  let newPos = pos + de;
  if(pos===19) newPos = pos+3; // case spéciale 19
  if(newPos>25) newPos=25;
  if(newPos===11) newPos=1; // case spéciale 11
  positionsJoueurs[joueurActuel]=newPos;
  const pion = joueurs[joueurActuel-1];
  pion.style.left = positions[newPos].x + joueurActuel*10 + "px";
  pion.style.top = positions[newPos].y + joueurActuel*10 + "px";
  afficherAction(newPos);
  // passer au joueur suivant
  tour = (tour%nbJoueurs)+1;
  tourContainer.textContent = "Tour: Joueur "+tour;
});

document.getElementById("reset").addEventListener("click",()=>{
  plateau.innerHTML="";
  bandeau.textContent="Bienvenue ! Cliquez sur Start pour commencer.";
  deContainer.textContent="Dé: 0";
  tourContainer.textContent="Tour: -";
  musique.pause();
  musique.currentTime=0;
});

document.getElementById("volume").addEventListener("click",()=>{
  if(musiqueOn){
    musique.pause();
    musiqueOn=false;
  } else{
    musique.play();
    musiqueOn=true;
  }
});

function afficherAction(caseNum){
  bandeau.textContent = actions[caseNum]?.texte || "";
  popup.textContent = actions[caseNum]?.pop || "";
  popup.style.left = positions[caseNum].x+60+"px";
  popup.style.top = positions[caseNum].y+60+"px";
  popup.style.display="block";
  const audio = new Audio(actions[caseNum]?.son);
  audio.play();
  setTimeout(()=>{popup.style.display="none";},4000);
}
</script>
</body>
</html>
