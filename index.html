<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Jeu de Plateau</title>
<style>
  body { background: #222; color: #fff; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin: 0; }
  #boardWrap { position: relative; width: 800px; height: 600px; background-image: url('https://raw.githubusercontent.com/stephanelavallee89-crypto/Mon-jeux-/main/plateau%20jeux.jpg'); background-size: contain; background-position: top left; background-repeat: no-repeat; margin-top:20px;}
  .pawn { position: absolute; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: default; transition: all 0.5s ease; }
  #controls { margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
  button { padding: 10px 20px; font-size: 16px; }
  #info { margin-top: 10px; width: 800px; height: 60px; background: #000; text-align: center; font-size: 18px; line-height: 60px; border: 2px solid #fff; }
  #dice { font-size: 24px; padding: 10px 20px; cursor: pointer; }
</style>
</head>
<body>

<h1>Jeu de Plateau</h1>

<div id="boardWrap"></div>

<div id="controls">
  <label>Joueurs: <select id="playerCount"><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></label>
  <button id="startBtn">Start</button>
  <button id="resetBtn">Reset</button>
  <button id="dice">🎲 Lancer</button>
  <button id="volumeBtn">🔊</button>
</div>

<div id="info">Cliquez sur Start pour commencer</div>

<audio id="music" loop>
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
</audio>

<script>
const board = document.getElementById('boardWrap');
const info = document.getElementById('info');
const music = document.getElementById('music');
let pawns = [];
let playerCount = 2;
let currentPlayer = 0;
let positions = [];
let moving = false;

// Coordonnées approximatives des 25 cases (en pixels dans boardWrap)
const caseCoords = [
  {x:50,y:50},{x:180,y:50},{x:310,y:50},{x:440,y:50},{x:570,y:50},
  {x:570,y:140},{x:570,y:230},{x:570,y:320},{x:570,y:410},{x:570,y:500},
  {x:440,y:500},{x:310,y:500},{x:180,y:500},{x:50,y:500},{x:50,y:410},
  {x:50,y:320},{x:50,y:230},{x:180,y:230},{x:310,y:320},{x:440,y:410},
  {x:310,y:410},{x:310,y:230},{x:180,y:320},{x:180,y:410},{x:310,y:310}
];

// Actions par case
const actions = [
  {action:"Tout le monde se sert à boire !", popup:"santé !", sound:"https://freesound.org/data/previews/341/341695_3248244-lq.mp3"},
  {action:"Fredonne la chanson que te souffle le joueur à ta droite", popup:"Met l'ambiance !", sound:"https://freesound.org/data/previews/341/341697_3248244-lq.mp3"},
  {action:"Embrasse le joueur à ta droite", popup:"smack", sound:"https://freesound.org/data/previews/341/341699_3248244-lq.mp3"},
  {action:"Pose une colle au joueur de ton choix", popup:"Culture G", sound:"https://freesound.org/data/previews/341/341700_3248244-lq.mp3"},
  {action:"Tout le monde trinque", popup:"tchin tchin", sound:"https://freesound.org/data/previews/341/341701_3248244-lq.mp3"},
  {action:"Échange un vêtement avec le joueur à ta gauche", popup:"Echange", sound:"https://freesound.org/data/previews/341/341702_3248244-lq.mp3"},
  {action:"Mime ce que te souffle le joueur de droite", popup:"Action!", sound:"https://freesound.org/data/previews/341/341703_3248244-lq.mp3"},
  {action:"", popup:"", sound:""},
  {action:"Échange ton verre avec le joueur à ta droite", popup:"C'est bon... ou pas !", sound:"https://freesound.org/data/previews/341/341704_3248244-lq.mp3"},
  {action:"Désigne ton joueur favori", popup:"Love", sound:"https://freesound.org/data/previews/341/341705_3248244-lq.mp3"},
  {action:"Retour à la case départ !", popup:"AÏE", sound:"https://freesound.org/data/previews/341/341706_3248244-lq.mp3"},
  {action:"Dessine ce que te souffle le joueur à ta gauche", popup:"Draw", sound:"https://freesound.org/data/previews/341/341707_3248244-lq.mp3"},
  {action:"Pose une colle au joueur de ton choix", popup:"Culture G", sound:"https://freesound.org/data/previews/341/341708_3248244-lq.mp3"},
  {action:"Embrasse le joueur à ta gauche", popup:"Smak", sound:"https://freesound.org/data/previews/341/341709_3248244-lq.mp3"},
  {action:"Échange un vêtement avec le joueur à ta droite", popup:"Echange", sound:"https://freesound.org/data/previews/341/341710_3248244-lq.mp3"},
  {action:"Passe ton tour ! Et bois un coup", popup:"Stop!", sound:"https://freesound.org/data/previews/341/341711_3248244-lq.mp3"},
  {action:"Échange ton verre avec le joueur à ta gauche", popup:"C'est bon... ou pas !", sound:"https://freesound.org/data/previews/341/341712_3248244-lq.mp3"},
  {action:"Dessine ce que te souffle le joueur à ta droite", popup:"Draw", sound:"https://freesound.org/data/previews/341/341713_3248244-lq.mp3"},
  {action:"Avance de trois cases", popup:"Tchou Tchou glou glou", sound:"https://freesound.org/data/previews/341/341714_3248244-lq.mp3"},
  {action:"Fredonne la chanson que te souffle le joueur à ta gauche", popup:"Met l'ambiance !", sound:"https://freesound.org/data/previews/341/341715_3248244-lq.mp3"},
  {action:"Pose une question osée au joueur de ton choix", popup:"Indiscretions", sound:"https://freesound.org/data/previews/341/341716_3248244-lq.mp3"},
  {action:"Cul sec !", popup:"Glou glou", sound:"https://freesound.org/data/previews/341/341717_3248244-lq.mp3"},
  {action:"Mime ce que te souffle le joueur à ta gauche", popup:"Action!", sound:"https://freesound.org/data/previews/341/341718_3248244-lq.mp3"},
  {action:"Pose une colle au joueur de ton choix", popup:"Culture G", sound:"https://freesound.org/data/previews/341/341719_3248244-lq.mp3"},
  {action:"Tu as gagné le droit de demander le service que tu veux", popup:"Winner!!!", sound:"https://freesound.org/data/previews/341/341720_3248244-lq.mp3"}
];

// Création des pions
function createPawns() {
  const colors = ["red","blue","green","yellow","orange","purple"];
  pawns.forEach(p=>p.remove());
  pawns = [];
  for(let i=0;i<playerCount;i++){
    const pawn = document.createElement("div");
    pawn.className = "pawn";
    pawn.style.backgroundColor = colors[i];
    pawn.textContent = i+1;
    board.appendChild(pawn);
    pawns.push({el:pawn,pos:0});
  }
}

// Afficher action + popup + son
function triggerAction(pos) {
  const act = actions[pos];
  if(!act) return;
  info.textContent = `Joueur ${currentPlayer+1}: ${act.action}`;
  const popup = document.createElement("div");
  popup.style.position="absolute";
  popup.style.top=caseCoords[pos].y+"px";
  popup.style.left=caseCoords[pos].x+"px";
  popup.style.padding="10px 15px";
  popup.style.background="rgba(255,255,0,0.9)";
  popup.style.color="#000";
  popup.style.border="2px solid #000";
  popup.style.fontWeight="bold";
  popup.style.borderRadius="5px";
  popup.textContent=act.popup;
  board.appendChild(popup);
  const audio = new Audio(act.sound);
  audio.play();
  setTimeout(()=>popup.remove(),4000);
}

// Déplacement du pion
function movePawn(player,steps){
  let pos = pawns[player].pos;
  for(let i=0;i<steps;i++){
    pos++;
    if(pos>=25) pos=24;
    if(pos==10) pos=0; // case 11 renvoie départ
    if(pos==18) pos+=3; // case 19 avance de 3
  }
  pawns[player].pos = pos;
  const coord = caseCoords[pos];
  pawns[player].el.style.left = coord.x + "px";
  pawns[player].el.style.top = coord.y + "px";
  triggerAction(pos);
}

// Gestion du tour
document.getElementById("startBtn").addEventListener("click",()=>{
  playerCount = parseInt(document.getElementById("playerCount").value);
  currentPlayer=0;
  createPawns();
  pawns.forEach(p=>{p.pos=0;p.el.style.left=caseCoords[0].x+"px";p.el.style.top=caseCoords[0].y+"px";});
  triggerAction(0);
  music.play();
});

document.getElementById("dice").addEventListener("click",()=>{
  if(moving) return;
  moving=true;
  const roll = Math.floor(Math.random()*6)+1;
  info.textContent += ` - Dé: ${roll}`;
  setTimeout(()=>{
    movePawn(currentPlayer,roll);
    currentPlayer = (currentPlayer+1)%playerCount;
    moving=false;
  },600);
});

document.getElementById("resetBtn").addEventListener("click",()=>{
  pawns.forEach(p=>p.el.remove());
  pawns=[];
  info.textContent="Cliquez sur Start pour commencer";
  music.pause();
  music.currentTime=0;
});
</script>
</body>
</html>
