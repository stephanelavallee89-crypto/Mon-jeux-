<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Jeu Spirale</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #222;
    color: #fff;
    text-align: center;
  }
  #plateau {
    position: relative;
    width: 500px;
    height: 500px;
    margin: 20px auto;
    background: url('https://raw.githubusercontent.com/stephanelavallee89-crypto/Mon-jeux-/main/plateau%20jeux.jpg') no-repeat;
    background-size: contain;
    border: 2px solid #fff;
  }
  .pion {
    position: absolute;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #fff;
    font-weight: bold;
    font-size: 18px;
  }
  #bandeau {
    width: 500px;
    margin: 20px auto;
    padding: 10px;
    background: #000;
    color: #fff;
    font-size: 18px;
    text-align: center;
  }
  #controls {
    margin: 10px;
  }
  button {
    margin: 5px;
    padding: 10px 15px;
    font-size: 16px;
  }
  #de {
    font-size: 24px;
    margin-left: 10px;
  }
</style>
</head>
<body>

<h1>Jeu Spirale</h1>

<div id="plateau"></div>
<div id="bandeau">Cliquez sur Start pour commencer</div>

<div id="controls">
  Joueurs:
  <select id="nbJoueurs">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
  </select>
  <button id="start">Start</button>
  <button id="roll">Lancer DÃ©</button>
  <button id="reset">Reset</button>
  <button id="musicBtn">ðŸŽµ</button>
  DÃ©: <span id="de">0</span>
  Tour: <span id="tourJoueur">-</span>
</div>

<audio id="musique" loop>
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
</audio>

<script>
const casesCoord = [
  {x:0,y:0},{x:100,y:0},{x:200,y:0},{x:300,y:0},{x:400,y:0},
  {x:400,y:100},{x:400,y:200},{x:400,y:300},{x:400,y:400},
  {x:300,y:400},{x:200,y:400},{x:100,y:400},{x:0,y:400},
  {x:0,y:300},{x:0,y:200},{x:0,y:100},{x:100,y:100},{x:200,y:100},
  {x:300,y:100},{x:300,y:200},{x:300,y:300},{x:200,y:300},{x:100,y:300},
  {x:100,y:200},{x:200,y:200} // 25
];

const actions = [
  "Tout le monde se sert Ã  boire !", "Fredonne la chanson que te souffle le joueur Ã  ta droite si les autres joueurs ne trouvent pas tu bois :)", 
  "Embrasse le joueur Ã  ta droite", "Pose une colle au joueur de ton choix s'il perd il boit sinon c'est toi ;)", 
  "Tout le monde trinque", "Echange un vÃªtement avec le joueur Ã  ta gauche et faites un selfie", 
  "Mime ce que te souffle le joueur de droite les autres joueurs trouvent pas tu bois ;)", 
  "","Echange ton verre avec le joueur Ã  ta droite", "DÃ©signe ton joueur favoris",
  "Retour Ã  la case dÃ©part !", "Dessine ce que te souffle le joueur Ã  ta gauche si les autres joueurs ne trouvent pas tu bois !",
  "Pose une colle au joueur de ton choix si il perd il boit sinon c'est toi ;)", "Embrasse le joueur Ã  ta gauche",
  "Echange un vÃªtement avec le joueur Ã  ta droite et faites un selfie", "Passe ton tour ! Et bois un coup tant qu'Ã  faire :)", 
  "Echange ton verre avec le joueur Ã  ta gauche", "Dessine ce que te souffle le joueur Ã  ta droite si les autres joueurs ne trouvent pas tu bois !",
  "Avance de trois cases ... je pense que tu avais soif :)", "Fredonne la chanson que te souffle le joueur Ã  ta gauche si les autres joueurs ne trouvent pas tu bois :)", 
  "Pose une question osÃ©e au joueur de ton choix s'il ne rÃ©pond pas il boit", "Cul sec !", 
  "Mime ce que te souffle le joueur Ã  ta gauche si les autres joueurs ne trouvent pas tu bois ;)", 
  "Pose une colle au joueur de ton choix si il perd il boit sinon c'est toi ;)", 
  "Tu as gagnÃ© le droit de demander le service que tu veux au joueur de ton choix"
];

let nbJoueurs = 1;
let pions = [];
let positions = [];
let tour = 0;

const plateau = document.getElementById('plateau');
const bandeau = document.getElementById('bandeau');
const deSpan = document.getElementById('de');
const tourJoueur = document.getElementById('tourJoueur');
const musique = document.getElementById('musique');
const musicBtn = document.getElementById('musicBtn');

document.getElementById('nbJoueurs').addEventListener('change', e => nbJoueurs = parseInt(e.target.value));

document.getElementById('start').addEventListener('click', () => {
  plateau.innerHTML = '';
  pions = [];
  positions = Array(nbJoueurs).fill(0);
  for(let i=0;i<nbJoueurs;i++){
    const pion = document.createElement('div');
    pion.classList.add('pion');
    pion.style.background = ['red','blue','green','orange','purple','pink'][i];
    pion.textContent = i+1;
    plateau.appendChild(pion);
    pions.push(pion);
    movePion(i,0);
  }
  tour = 0;
  tourJoueur.textContent = `Joueur ${tour+1}`;
  showAction(0);
  musique.play();
});

document.getElementById('roll').addEventListener('click', () => {
  const val = Math.floor(Math.random()*6)+1;
  deSpan.textContent = val;
  moveCurrentPlayer(val);
});

document.getElementById('reset').addEventListener('click', () => location.reload());

musicBtn.addEventListener('click', () => {
  if(musique.paused) musique.play(); else musique.pause();
});

function movePion(i, pos){
  const coord = casesCoord[pos];
  pions[i].style.left = coord.x + 'px';
  pions[i].style.top = coord.y + 'px';
  positions[i] = pos;
}

function showAction(pos){
  bandeau.textContent = actions[pos];
}

function moveCurrentPlayer(val){
  let pos = positions[tour];
  pos += val;
  // case 19
  if(pos === 18) pos += 3;
  // case 11
  if(pos === 10) pos = 0;
  if(pos>24) pos=24;
  movePion(tour,pos);
  showAction(pos);
  tour = (tour+1)%nbJoueurs;
  tourJoueur.textContent = `Joueur ${tour+1}`;
}
</script>

</body>
</html>
